{% extends "base.html" %}

{% block content %}
<style>
    /* è¯¦æƒ…é¡µä¹Ÿéœ€è¦è¿™äº›å¤åˆ¶æŒ‰é’®çš„æ ·å¼ï¼Œè¿™é‡Œå¤ç”¨ */
    .copy-input-group {
        display: flex; align-items: center;
        border: 1px solid #dee2e6; border-radius: 6px;
        background-color: #f8f9fa; overflow: hidden;
        transition: border-color 0.2s;
    }
    .copy-input-group:hover { border-color: #b3b3b3; }
    .copy-input-group input {
        border: none; box-shadow: none; background: transparent;
        flex: 1; padding: 10px; font-family: monospace;
        font-size: 13px; color: #555; outline: none; cursor: text;
    }
    .copy-btn-icon {
        border: none; border-left: 1px solid #dee2e6;
        background: white; color: #666; width: 40px; align-self: stretch;
        cursor: pointer; display: flex; align-items: center; justify-content: center;
        transition: all 0.2s; font-size: 16px;
    }
    .copy-btn-icon:hover { background: #f0f0f0; color: #007bff; }
    .copy-btn-icon:active { background: #e2e6ea; }
</style>

<div class="header-row">
    <div>
        <a href="/dashboard" style="text-decoration: none; color: #666; font-size: 14px;">â† è¿”å›ä»ªè¡¨ç›˜</a>
        <h2 style="margin: 5px 0;">{{ app.name }}</h2>
        <span style="background: #e9ecef; color: #666; padding: 2px 8px; border-radius: 4px; font-size: 12px;">App Details</span>
    </div>
    <div style="display:flex; gap:10px;">
        <a href="/apps/{{ app.client_id }}/stats" class="btn" style="background: linear-gradient(135deg, #a18cd1 0%, #fbc2eb 100%); color: white; text-decoration: none; display: flex; align-items: center; gap: 5px;">
            ğŸ“ˆ æ•°æ®åˆ†æ
        </a>
        <form action="/apps/{{ app.client_id }}/delete" method="POST" onsubmit="return confirm('âš ï¸ ç¡®å®šè¦å½»åº•åˆ é™¤æ­¤åº”ç”¨å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ’¤é”€ï¼Œä¸”ä¼šä½¿å¾—æ‰€æœ‰å·²åˆ†å‘çš„ Token å¤±æ•ˆã€‚');" style="margin:0;">
            <button type="submit" class="btn btn-danger">ğŸ—‘ï¸ åˆ é™¤åº”ç”¨</button>
        </form>
    </div>
</div>

<!-- ç»Ÿè®¡æ•°æ® -->
<h3 style="margin-top: 30px; color: #555;">ğŸ“Š è°ƒç”¨ç»Ÿè®¡</h3>
<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; margin-bottom: 30px;">
    <div class="card" style="margin:0; text-align: center; padding: 20px;">
        <div style="font-size: 28px; font-weight: bold; color: #007bff;">{{ stats['1h'] }}</div>
        <div style="font-size: 12px; color: #888; margin-top: 5px;">è¿‘ 1 å°æ—¶</div>
    </div>
    <div class="card" style="margin:0; text-align: center; padding: 20px;">
        <div style="font-size: 28px; font-weight: bold; color: #28a745;">{{ stats['24h'] }}</div>
        <div style="font-size: 12px; color: #888; margin-top: 5px;">è¿‘ 24 å°æ—¶</div>
    </div>
    <div class="card" style="margin:0; text-align: center; padding: 20px;">
        <div style="font-size: 28px; font-weight: bold; color: #fd7e14;">{{ stats['7d'] }}</div>
        <div style="font-size: 12px; color: #888; margin-top: 5px;">è¿‘ 7 å¤©</div>
    </div>
    <div class="card" style="margin:0; text-align: center; padding: 20px;">
        <div style="font-size: 28px; font-weight: bold; color: #6f42c1;">{{ stats['30d'] }}</div>
        <div style="font-size: 12px; color: #888; margin-top: 5px;">è¿‘ 30 å¤©</div>
    </div>
</div>

<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; flex-wrap: wrap;">
    <!-- åŸºæœ¬ä¿¡æ¯ -->
    <div class="card" style="margin:0;">
        <h3 style="margin-top:0; border-bottom: 1px solid #eee; padding-bottom: 10px;">åŸºæœ¬ä¿¡æ¯</h3>
        <form action="/apps/{{ app.client_id }}/update" method="POST">
            <div class="input-group">
                <label>åº”ç”¨åç§°</label>
                <input type="text" name="name" value="{{ app.name }}" required>
            </div>
            <div class="input-group">
                <label>å›è°ƒåœ°å€ (Redirect URI)</label>
                <input type="text" name="redirect_uri" value="{{ app.redirect_uri }}" required>
            </div>
            <div style="text-align: right; margin-top: 15px;">
                <button type="submit" class="btn btn-primary">ä¿å­˜ä¿®æ”¹</button>
            </div>
        </form>
    </div>

    <!-- å‡­è¯ç®¡ç† -->
    <div class="card" style="margin:0;">
        <h3 style="margin-top:0; border-bottom: 1px solid #eee; padding-bottom: 10px;">å‡­è¯ç®¡ç† (Credentials)</h3>
        
        <!-- Client ID (æ–¹æ¡ˆB) -->
        <div class="input-group">
            <label>Client ID</label>
            <div class="copy-input-group">
                <input type="text" value="{{ app.client_id }}" readonly>
                <button type="button" class="copy-btn-icon" onclick="copyToClipboard(this.previousElementSibling)" title="å¤åˆ¶ ID">ğŸ“‹</button>
            </div>
        </div>
        
        <!-- Client Secret (æ–¹æ¡ˆB) -->
        <div class="input-group">
            <label>Client Secret</label>
            <div class="copy-input-group">
                <input type="text" value="{{ app.client_secret }}" readonly>
                <button type="button" class="copy-btn-icon" onclick="copyToClipboard(this.previousElementSibling)" title="å¤åˆ¶ Secret">ğŸ“‹</button>
            </div>
            <p style="font-size: 12px; color: #dc3545; margin-top: 5px;">âš ï¸ Secret æ³„éœ²? è¯·ç«‹å³é‡ç½®ã€‚</p>
        </div>

        <form action="/apps/{{ app.client_id }}/regenerate_secret" method="POST" onsubmit="return confirm('ç¡®å®šè¦é‡ç½® Client Secret å—ï¼Ÿ\n\næ—§çš„ Secret å°†ç«‹å³å¤±æ•ˆï¼Œæ‚¨éœ€è¦æ›´æ–°æ‰€æœ‰å®¢æˆ·ç«¯ä»£ç ã€‚');" style="text-align: right;">
            <button type="submit" class="btn btn-ghost" style="color: #dc3545; border-color: #dc3545;">ğŸ”„ é‡ç½® Secret</button>
        </form>
    </div>
</div>
{% endblock %}